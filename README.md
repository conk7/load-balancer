# load-balancer

Данный репозиторий содержит код простого балансировщика нагрузки, развертываемого на локальной сети. Балансировщик написан с использованием FastAPI. 

# Зависимости
Для балансировщика нагрузки достаточно:
1. FastAPI
2. requests
3. Uvicorn
4. Pydantic

Для тестового клиента также понадобятся
1. asyncio
2. aiohttp

# Инструкция

Для начала, нужно запустить сам балансировщик нагрузки. Для этого нужно открыть консоль в директории склонированного репозитория и ввести команду:

```
> uvicorn src.load_balancer.load_balancer:load_balancer --port 8080
```
Она запустит балансировщик нагрузки на локальном сервере. 

Далее, нужно локально запустить копии серверов, выполняющих задачи. Для этого нужно сделать post-запрос балансировщику нагрузки, в котором нужно указать тип сервера и количество копий.

Пример запроса:
```
POST http://127.0.0.1:8080/api/private/addNewCopy
Content-Type: application/json

{
    "type": "src.server.resources:server",
    "n": 3
}
```
Копии серверов можно удалять. Для этого есть свой post-запрос балансировщику нагрузки, аналогичный предыдущему.

Пример запроса:
```
POST http://127.0.0.1:8080/api/private/DeleteCopy
Content-Type: application/json

{
    "type": "src.server.resources:server",
    "n": 3
}
```

Для отправки задачи нужно сделать post-запрос балансировщику нагрузки, в теле которого должен быть тип задачи (generate_nth_fibonacci или generate_n_factorial) и число n.

Пример запроса:
```
POST http://127.0.0.1:8080/api/private/sendTask
Content-Type: application/json

{
    "type": "generate_nth_fibonacci",
    "n": 123
}
```
# Клиент

В репозитории также присутствует тестовый клиент, который одновременно отправляет запросы, получает на них ответы от серверов, показывает количество выполненых задач каждым сервером и затраченное на их выполние время. С помощью него можно легко убедиться в работоспособности балансировщика нагрузки и равномерном распределении им задач по серверам.

Для запуска клиента нужно открыть консоль в директории склонированного репозитория и ввести команду:

```
> python -m src.client.client
```